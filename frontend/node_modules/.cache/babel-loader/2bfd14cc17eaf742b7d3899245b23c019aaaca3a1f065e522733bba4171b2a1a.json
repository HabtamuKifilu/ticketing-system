{"ast":null,"code":"var _jsxFileName = \"/home/moheranus/Documents/2016/upwork/kosii/ticketing-system/frontend/src/components/Login.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { Navigate, Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass Login extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      email: '',\n      password: '',\n      errors: {},\n      serverError: '',\n      loading: false\n    };\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const {\n        email,\n        password\n      } = this.state;\n      let errors = {};\n      if (!email) errors.email = 'Email cannot be empty';\n      if (!password) errors.password = 'Password cannot be empty';\n      if (Object.keys(errors).length > 0) {\n        this.setState({\n          errors,\n          serverError: ''\n        });\n        return;\n      }\n      this.setState({\n        loading: true,\n        errors: {},\n        serverError: ''\n      });\n      try {\n        const res = await axios.post('http://localhost:5000/api/auth/login', {\n          email,\n          password\n        });\n        const {\n          token\n        } = res.data;\n        const decoded = JSON.parse(atob(token.split('.')[1]));\n        this.props.dispatch({\n          type: 'SET_AUTH',\n          token,\n          role: decoded.role,\n          email,\n          firstName: decoded.firstName,\n          lastName: decoded.lastName\n        });\n      } catch (err) {\n        var _err$response;\n        const errorMsg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data.msg) || 'Login failed. Please try again.';\n        if (errorMsg === 'Invalid credentials') {\n          this.setState({\n            errors: {\n              password: 'Email or password is incorrect'\n            },\n            serverError: '',\n            loading: false\n          });\n        } else {\n          this.setState({\n            serverError: errorMsg,\n            errors: {},\n            loading: false\n          });\n        }\n      }\n    };\n  }\n  render() {\n    const {\n      token,\n      role\n    } = this.props;\n    if (token) return role === 'admin' ? /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/admin-dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/user-dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 79\n    }, this);\n    const {\n      email,\n      password,\n      errors,\n      serverError,\n      loading\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-screen bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"bg-white p-8 rounded-lg shadow-md w-full max-w-md space-y-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-3xl font-bold text-center text-gray-800\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), serverError && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-red-600 text-center bg-red-100 p-2 rounded\",\n          children: serverError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            value: email,\n            onChange: e => this.setState({\n              email: e.target.value\n            }),\n            placeholder: \"Email\",\n            className: `w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.email ? 'border-red-500' : ''}`,\n            disabled: loading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 13\n          }, this), errors.email && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-red-500 text-sm mt-1\",\n            children: errors.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: password,\n            onChange: e => this.setState({\n              password: e.target.value\n            }),\n            placeholder: \"Password\",\n            className: `w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.password ? 'border-red-500' : ''}`,\n            disabled: loading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), errors.password && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-red-500 text-sm mt-1\",\n            children: errors.password\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition disabled:bg-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          disabled: loading,\n          children: loading ? 'Logging in...' : 'Login'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-center text-gray-600\",\n          children: [\"Don\\u2019t have an account? \", /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/signup\",\n            className: \"text-blue-600 hover:underline\",\n            children: \"Sign up\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 36\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this);\n  }\n}\nconst mapStateToProps = state => ({\n  token: state.token,\n  role: state.role\n});\nexport default connect(mapStateToProps)(Login);","map":{"version":3,"names":["React","axios","connect","Navigate","Link","jsxDEV","_jsxDEV","Login","Component","constructor","args","state","email","password","errors","serverError","loading","handleSubmit","e","preventDefault","Object","keys","length","setState","res","post","token","data","decoded","JSON","parse","atob","split","props","dispatch","type","role","firstName","lastName","err","_err$response","errorMsg","response","msg","render","to","fileName","_jsxFileName","lineNumber","columnNumber","className","children","onSubmit","value","onChange","target","placeholder","disabled","mapStateToProps"],"sources":["/home/moheranus/Documents/2016/upwork/kosii/ticketing-system/frontend/src/components/Login.js"],"sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { Navigate, Link } from 'react-router-dom';\n\nclass Login extends React.Component {\n  state = { \n    email: '', \n    password: '', \n    errors: {},\n    serverError: '',\n    loading: false \n  };\n\n  handleSubmit = async (e) => {\n    e.preventDefault();\n    const { email, password } = this.state;\n    let errors = {};\n\n    if (!email) errors.email = 'Email cannot be empty';\n    if (!password) errors.password = 'Password cannot be empty';\n\n    if (Object.keys(errors).length > 0) {\n      this.setState({ errors, serverError: '' });\n      return;\n    }\n\n    this.setState({ loading: true, errors: {}, serverError: '' });\n    try {\n      const res = await axios.post('http://localhost:5000/api/auth/login', { email, password });\n      const { token } = res.data;\n      const decoded = JSON.parse(atob(token.split('.')[1]));\n      this.props.dispatch({ \n        type: 'SET_AUTH', \n        token, \n        role: decoded.role, \n        email,\n        firstName: decoded.firstName,\n        lastName: decoded.lastName\n      });\n    } catch (err) {\n      const errorMsg = err.response?.data.msg || 'Login failed. Please try again.';\n      if (errorMsg === 'Invalid credentials') {\n        this.setState({ \n          errors: { password: 'Email or password is incorrect' }, \n          serverError: '', \n          loading: false \n        });\n      } else {\n        this.setState({ serverError: errorMsg, errors: {}, loading: false });\n      }\n    }\n  };\n\n  render() {\n    const { token, role } = this.props;\n    if (token) return role === 'admin' ? <Navigate to=\"/admin-dashboard\" /> : <Navigate to=\"/user-dashboard\" />;\n\n    const { email, password, errors, serverError, loading } = this.state;\n\n    return (\n      <div className=\"flex justify-center items-center h-screen bg-gray-50\">\n        <form onSubmit={this.handleSubmit} className=\"bg-white p-8 rounded-lg shadow-md w-full max-w-md space-y-6\">\n          <h2 className=\"text-3xl font-bold text-center text-gray-800\">Login</h2>\n          {serverError && (\n            <p className=\"text-red-600 text-center bg-red-100 p-2 rounded\">{serverError}</p>\n          )}\n          <div>\n            <input\n              type=\"email\"\n              value={email}\n              onChange={(e) => this.setState({ email: e.target.value })}\n              placeholder=\"Email\"\n              className={`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.email ? 'border-red-500' : ''}`}\n              disabled={loading}\n            />\n            {errors.email && <p className=\"text-red-500 text-sm mt-1\">{errors.email}</p>}\n          </div>\n          <div>\n            <input\n              type=\"password\"\n              value={password}\n              onChange={(e) => this.setState({ password: e.target.value })}\n              placeholder=\"Password\"\n              className={`w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.password ? 'border-red-500' : ''}`}\n              disabled={loading}\n            />\n            {errors.password && <p className=\"text-red-500 text-sm mt-1\">{errors.password}</p>}\n          </div>\n          <button\n            type=\"submit\"\n            className=\"w-full bg-blue-600 text-white p-3 rounded-lg hover:bg-blue-700 transition disabled:bg-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            disabled={loading}\n          >\n            {loading ? 'Logging in...' : 'Login'}\n          </button>\n          <p className=\"text-center text-gray-600\">\n            Don’t have an account? <Link to=\"/signup\" className=\"text-blue-600 hover:underline\">Sign up</Link>\n          </p>\n        </form>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({ token: state.token, role: state.role });\nexport default connect(mapStateToProps)(Login);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}